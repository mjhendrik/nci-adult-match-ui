<div class="load-content" *ngIf="!dataAvailable && overviewDataAvailable">
  <div id="page-loader" class="page-loader fade in"><span class="spinner">Loading...</span></div>
</div>
<div id="content" class="content" *ngIf="dataAvailable && overviewDataAvailable">
  <div class="row">
    <div class="p-l-15 f-s-10 text-muted-dark pull-right dashboard-loaded-at">
      Loaded at {{timestamp | date: 'mediumTime'}}
    </div>
    <!-- begin col-4 -->
    <div class="col-md-4" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}" id="patient_summary">
      <a class="link-none" href="javascript:void(0)" [routerLink]="['/patients']">
        <div class="widget widget-stat bg-purple-light text-white">
          <div class="widget-stat-icon"><i class="fa fa-users fa-lg"></i></div>
          <div class="widget-stat-info">
            <div class="widget-stat-title text-right">Patients</div>
            <div class="widget-stat-number text-right">{{patients.total}}</div>
            <div class="widget-stat-text text-right">{{patients.onTreatmentArm}} On Treatment Arm&nbsp;&nbsp;|&nbsp;&nbsp;{{patients.offTrial}} Off Trial</div>
          </div>
        </div>
      </a>
    </div>
    <!-- end col-4 -->
    <!-- begin col-4 -->
    <div class="col-md-4" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}" id="treatment_arm_summary">
      <a class="link-none" href="javascript:void(0)" [routerLink]="['/treatments']">
        <div class="widget widget-stat bg-success-light text-white">
          <div class="widget-stat-icon"><i class="fa fa-medkit fa-lg"></i></div>
          <div class="widget-stat-info">
            <div class="widget-stat-title text-right">Treatment Arms</div>
            <div class="widget-stat-number text-right">{{treatmentArms.total}}</div>
            <div class="widget-stat-text text-right">{{treatmentArms.open}} Open&nbsp;&nbsp;|&nbsp;&nbsp;{{treatmentArms.suspended}} Suspended&nbsp;&nbsp;|&nbsp;&nbsp;{{treatmentArms.closed}}
              Closed
            </div>
          </div>
        </div>
      </a>
    </div>
    <!-- end col-4 -->
    <!-- begin col-4 -->
    <div class="col-md-4" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}" id="biopsy_summary">
      <a class="link-none" href="javascript:void(0)" [routerLink]="['/tracking']">
        <div class="widget widget-stat bg-info-light text-white">
          <div class="widget-stat-icon"><i class="fa fa-truck fa-lg"></i></div>
          <div class="widget-stat-info">
            <div class="widget-stat-title text-right">Biopsy Tracking</div>
            <div class="widget-stat-number text-right">{{biopsyTracking.total}}</div>
            <div class="widget-stat-text text-right">{{biopsyTracking.biopsySequences}} Biopsy Sequences&nbsp;&nbsp;|&nbsp;&nbsp;{{biopsyTracking.molecularSequences}}
              Molecular Sequences</div>
          </div>
        </div>
      </a>
    </div>
    <!-- end col-3 -->
    <!-- begin col-3 -->
    <!--<div class="col-md-3" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">
      <a class="link-none" href="javascript:void(0)" [routerLink]="['/clia']">
        <div class="widget widget-stat bg-orangeshade-light text-white">
          <div class="widget-stat-icon"><i class="fa fa-flask fa-lg"></i></div>
          <div class="widget-stat-info">
            <div class="widget-stat-title text-right">CLIA Labs</div>
            <div class="widget-stat-number text-right">PC&nbsp;&nbsp;|&nbsp;&nbsp;NTC&nbsp;&nbsp;|&nbsp;&nbsp;PACC</div>
            <div class="widget-stat-text text-right">MoCha&nbsp;&nbsp;|&nbsp;&nbsp;Yale&nbsp;&nbsp;|&nbsp;&nbsp;MGH&nbsp;&nbsp;|&nbsp;&nbsp;MDA&nbsp;&nbsp;|&nbsp;&nbsp;Dartmouth</div>
          </div>
        </div>
      </a>
    </div>-->
    <!-- end col-3 -->
    <div class="col-md-12">
      <!-- begin panel -->
      <h1 class="page-header">Pending Review</h1>
      <div class="panel">
        <div class="m-0 p-0">
          <div>
            <!--panel-purple-->
            <ul class="nav nav-tabs nav-tabs-purple p-l-0">
              <li class="active">
                <a class="p-0" href="#tab-AR" data-toggle="tab" aria-expanded="false">
                  <div class="panel-heading">
                    <div class="panel-heading-btn">
                    </div>
                    <h4 class="panel-title">Assignment Reports</h4>
                  </div>
                </a>
              </li>
              <li>
                <a class="p-0" href="#tab-VR" data-toggle="tab" aria-expanded="true">
                  <div class="panel-heading">
                    <div class="panel-heading-btn">
                    </div>
                    <h4 class="panel-title">Variant Reports</h4>
                  </div>
                </a>
              </li>
            </ul>
            <div class="tab-content m-b-0 p-l-10 p-r-10 p-t-0 p-b-0">

              <div class="tab-pane fade active in" id="tab-AR">
                <!-- table 2 -->
                <div class="row">
                  <!-- begin panel -->
                  <div>
                    <div class="col-md-12 bg-purple-light">
                      <div class="col-md-6 p-l-5">
                        <div class="dataTables_length text-white form-inline p-t-15 p-b-10" id="data-table_length">
                          <label>Show
                        <select [disabled]="tableARData.length == 0" name="data-table_length" [(ngModel)]="recordsPerPageAR"  aria-controls="data-table" class="form-control form-control-purple input-sm">
                          <option value=10>10</option>
                          <option value=25>25</option>
                          <option value=50>50</option>
                          <option value=100>100</option>
                        </select>
                      entries</label>
                        </div>
                      </div>
                      <div class="col-md-6 p-r-5">
                        <div id="data-table_filter" class="dataTables_filter pull-right text-white form-inline p-t-15 p-b-10">
                          <label>Search:
                        <input [disabled]="tableARData.length == 0" type="text" [(ngModel)]="searchtermAR" class="form-control form-control-purple input-sm" placeholder="" aria-controls="data-table">
                      </label>
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="table-responsive col-lg-12">
                        <table *ngIf="tableARData.length == 0" class="table table-td-valign-middle table-striped table-col-width">
                          <thead>
                            <tr class="purple-light">
                              <th>
                                Patient Sequence Number
                              </th>
                              <th>
                                Biopsy Sequence Number
                              </th>
                              <th>
                                Molecular Sequence Number
                              </th>
                              <th>
                                Selected Treatment Arm
                              </th>
                              <th class="text-center">
                                Assignment Report
                              </th>
                              <th>
                                Assignment Date
                              </th>
                              <th>
                                Hours Pending
                              </th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr>
                              <td class="text-muted" colspan="7">There are no pending assignment reports that need review</td>
                            </tr>
                          </tbody>
                        </table>
                        <table *ngIf="tableARData.length!=0" class="table table-td-valign-middle table-striped table-col-width" [mfData]="tableARData | filterByText: searchtermAR"
                          #mftableAR="mfDataTable" [(mfSortBy)]="tableARDefaultSort" [(mfSortOrder)]="sortByDesc" [mfRowsOnPage]="recordsPerPageAR">
                          <thead>
                            <tr class="purple-light">
                              <th>
                                <mfDefaultSorter by="patientSequenceNumber"><span class="table-header">Patient Sequence Number</span></mfDefaultSorter>
                              </th>
                              <th>
                                <mfDefaultSorter by="biopsySequenceNumber"><span class="table-header">Biopsy Sequence Number</span></mfDefaultSorter>
                              </th>
                              <th>
                                <mfDefaultSorter by="molecularSequenceNumber"><span class="table-header">Molecular Sequence Number</span></mfDefaultSorter>
                              </th>
                              <th>
                                <mfDefaultSorter by="treatmentArm.id"><span class="table-header">Selected Treatment Arm</span></mfDefaultSorter>
                              </th>
                              <th class="text-center">
                                Assignment Report
                              </th>
                              <th>
                                <mfDefaultSorter by="dateAssigned"><span class="table-header">Assignment Date</span></mfDefaultSorter>
                              </th>
                              <th>
                                <mfDefaultSorter by="hoursPending"><span class="table-header">Hours Pending</span></mfDefaultSorter>
                              </th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr *ngFor="let item of mftableAR.data">
                              <td routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">
                                <a href [routerLink]="['/patients', item.patientSequenceNumber]" class="link-none"><i class="fa fa-user"></i> {{item.patientSequenceNumber | dashify}}</a>
                              </td>
                              <td routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">
                                <a href [routerLink]="['/patients', item.patientSequenceNumber]" class="link-none"><i class="fa fa-tasks"></i> {{item.biopsySequenceNumber | dashify}}</a>
                              </td>
                              <td routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">
                                <a href [routerLink]="['/patients', item.patientSequenceNumber]" class="link-none"><i class="fa fa-share-alt"></i> {{item.molecularSequenceNumber | dashify}}</a>
                              </td>
                              <td routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">
                                <treatment-arm-link *ngIf="item.treatmentArm.id" [treatmentArmId]="item.treatmentArm.id" [version]="item.treatmentArm.version"></treatment-arm-link>
                                <span *ngIf="!item.treatmentArm.id">No available treatment arm</span>
                              </td>
                              <td class="text-center"><a href [routerLink]="['/patients/' + item.patientSequenceNumber + '/variant_reports/' + item.analysisId]"
                                  class="link-none"><i class="fa fa-file-text-o"></i></a></td>
                              <td>{{item.dateAssigned | dashify}}</td>
                              <td [colorCodeHours]="item.hoursPending">{{item.hoursPending | dashify}}</td>
                            </tr>
                            <tr *ngIf="mftableAR.data.length == 0">
                              <td class="text-muted" colspan="7">No matching search results found for "{{searchtermAR}}"</td>
                            </tr>
                          </tbody>
                          <tfoot>
                            <tr>
                              <td class="tfoot-padding" colspan="7">
                                <mfBootstrapPaginator [rowsOnPageSet]="[10,25,50,100]" [search]="searchtermAR" [totallength]="tableARData.length"></mfBootstrapPaginator>
                              </td>
                            </tr>
                          </tfoot>
                        </table>
                      </div>
                    </div>
                  </div>
                  <!-- end panel -->
                </div>
              </div>
              <div class="tab-pane fade" id="tab-VR">
                <!-- table 1 -->
                <div class="row">
                  <!-- begin panel -->
                  <div>
                    <div class="col-md-12 bg-purple-light">
                      <div class="col-md-6 p-l-5">
                        <div class="dataTables_length text-white form-inline p-t-15 p-b-10" id="data-table_length">
                          <label>Show
                        <select [disabled]="tableVRData.length == 0" name="data-table_length" [(ngModel)]="recordsPerPageVR" aria-controls="data-table" class="form-control form-control-purple input-sm">
                          <option [ngValue]=10>10</option>
                          <option [ngValue]=25>25</option>
                          <option [ngValue]=50>50</option>
                          <option [ngValue]=100>100</option>
                        </select>
                      entries</label>
                        </div>
                      </div>
                      <div class="col-md-6 p-r-5">
                        <div id="data-table_filter" class="dataTables_filter pull-right text-white form-inline p-t-15 p-b-10">
                          <label>Search:
                        <input [disabled]="tableVRData.length == 0" type="text" [(ngModel)]="searchtermVR" class="form-control form-control-purple input-sm" placeholder="" aria-controls="data-table">
                        </label>
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="table-responsive col-lg-12">
                        <table *ngIf="tableVRData.length == 0" class="table table-td-valign-middle table-striped table-col-width">
                          <thead>
                            <tr class="purple-light">
                              <th>
                                Patient Sequence Number
                              </th>
                              <th>
                                Biopsy Sequence Number
                              </th>
                              <th>
                                Molecular Sequence Number
                              </th>
                              <th class="text-center">
                                Variant Report
                              </th>
                              <th>
                                Location
                              </th>
                              <th>
                                Specimen Received Date
                              </th>
                              <th>
                                Variant Report Recieved Date
                              </th>
                              <th>
                                Days Pending
                              </th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr>
                              <td class="text-muted" colspan="8">There are no pending variant reports that need review</td>
                            </tr>
                          </tbody>
                        </table>
                        <table *ngIf="tableVRData!=0" class="table table-td-valign-middle table-striped table-col-width" [mfData]="tableVRData | filterByText: searchtermVR"
                          #mftableVR="mfDataTable" [(mfSortBy)]="tableVRDefaultSort" [(mfSortOrder)]="sortByDesc" [mfRowsOnPage]="recordsPerPageVR">
                          <thead>
                            <tr class="purple-light">
                              <th>
                                <mfDefaultSorter by="patientSequenceNumber"><span class="table-header">Patient Sequence Number</span></mfDefaultSorter>
                              </th>
                              <th>
                                <mfDefaultSorter by="biopsySequenceNumber"><span class="table-header">Biopsy Sequence Number</span></mfDefaultSorter>
                              </th>
                              <th>
                                <mfDefaultSorter by="molecularSequenceNumber"><span class="table-header">Molecular Sequence Number</span></mfDefaultSorter>
                              </th>
                              <th class="text-center">
                                Variant Report
                              </th>
                              <th>
                                <mfDefaultSorter by="location"><span class="table-header">Location</span></mfDefaultSorter>
                              </th>
                              <th>
                                <mfDefaultSorter by="specimenReceivedDate"><span class="table-header">Specimen Received Date</span></mfDefaultSorter>
                              </th>
                              <th>
                                <mfDefaultSorter by="ngsDateReceived"><span class="table-header">Variant Report Recieved Date</span></mfDefaultSorter>
                              </th>
                              <th>
                                <mfDefaultSorter by="daysPending"><span class="table-header">Days Pending</span></mfDefaultSorter>
                              </th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr *ngFor="let item of mftableVR.data">
                              <td routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">
                                <a href [routerLink]="['/patients', item.patientSequenceNumber]" class="link-none"><i class="fa fa-user"></i> {{item.patientSequenceNumber | dashify}}</a>
                              </td>
                              <td><a href [routerLink]="['/patients', item.patientSequenceNumber]" class="link-none"><i class="fa fa-tasks"></i> {{item.biopsySequenceNumber | dashify}}</a></td>
                              <td><a href [routerLink]="['/patients', item.patientSequenceNumber]" class="link-none"><i class="fa fa-share-alt"></i> {{item.molecularSequenceNumber | dashify}}</a></td>
                              <td class="text-center"><a href [routerLink]="['/patients/' + item.patientSequenceNumber + '/variant_reports/' + item.analysisId]"
                                  class="link-none"><i class="fa fa-file-text-o"></i></a></td>
                              <td>{{item.location | dashify}}</td>
                              <td>{{item.specimenReceivedDate | dashify}}</td>
                              <td>{{item.ngsDateReceived | dashify}}</td>
                              <td [colorCodeDays]="item.daysPending">{{item.daysPending | dashify}}</td>
                            </tr>
                            <tr *ngIf="mftableVR.data.length == 0">
                              <td class="text-muted" colspan="8">No matching search results found for "{{searchtermVR}}"</td>
                            </tr>
                          </tbody>
                          <tfoot>
                            <tr>
                              <td class="tfoot-padding" colspan="8">
                                <mfBootstrapPaginator [rowsOnPageSet]="[10,25,50,100]" [search]="searchtermVR" [totallength]="tableVRData.length"></mfBootstrapPaginator>
                              </td>
                            </tr>
                          </tfoot>
                        </table>
                      </div>
                    </div>
                  </div>
                  <!-- end panel -->
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- end panel -->
    </div>
    <!-- table 3 -->
    <div class="col-md-12">
      <!-- begin panel -->
      <h1 class="page-header">Patients Awaiting Further Action Or Information</h1>
      <div class="panel" id="limbo_panel">
        <div class="col-md-12 bg-purple-light">
          <div class="col-md-6 p-l-5">
            <div class="dataTables_length text-white form-inline p-t-15 p-b-10" id="data-table_length">
              <label>Show
                        <select [disabled]="tablePatientsAwaitingData.length == 0" name="data-table_length" [(ngModel)]="recordsPerPagePatientsAwaiting" aria-controls="data-table" class="form-control form-control-purple input-sm">
                          <option value=10>10</option>
                          <option value=25>25</option>
                          <option value=50>50</option>
                          <option value=100>100</option>
                        </select>
                      entries</label>
            </div>
          </div>
          <div class="col-md-6 p-r-5">
            <div id="data-table_filter" class="dataTables_filter pull-right text-white form-inline p-t-15 p-b-10">
              <label>Search:
              <input [disabled]="tablePatientsAwaitingData.length == 0" type="text" [(ngModel)]="searchtermPatientsAwaiting" class="form-control form-control-purple input-sm" placeholder="" aria-controls="data-table">
                      </label>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="table-responsive col-lg-12">
            <table *ngIf="tablePatientsAwaitingData.length == 0" class="table table-td-valign-middle table-striped table-col-width">
              <thead>
                <tr class="purple-light">
                  <th>
                    Patient Sequence Number
                  </th>
                  <th>
                    Biopsy Sequence Number
                  </th>
                  <th>
                    Molecular Sequence Number
                  </th>
                  <th class="text-center">
                    Variant Report
                  </th>
                  <th>
                    Reason
                  </th>
                  <th>
                    AMOI
                  </th>
                  <th>
                    Confirmation Date
                  </th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-muted" colspan="7">There are no patients awaiting further action or information</td>
                </tr>
              </tbody>
            </table>
            <table *ngIf="tablePatientsAwaitingData.length!=0" class="table table-td-valign-middle table-striped table-col-width" [mfData]="tablePatientsAwaitingData | filterByText: searchtermPatientsAwaiting"
              #mftablePatientsAwaiting="mfDataTable" [(mfSortBy)]="tablePatientsAwaitingDefaultSort" [mfRowsOnPage]="recordsPerPagePatientsAwaiting">
              <thead>
                <tr class="purple-light">
                  <th>
                    <mfDefaultSorter by="psn"><span class="table-header">Patient Sequence Number</span></mfDefaultSorter>
                  </th>
                  <th>
                    <mfDefaultSorter by="bsn"><span class="table-header">Biopsy Sequence Number</span></mfDefaultSorter>
                  </th>
                  <th>
                    <mfDefaultSorter by="msn"><span class="table-header">Molecular Sequence Number</span></mfDefaultSorter>
                  </th>
                  <th class="text-center">
                    Variant Report
                  </th>
                  <th>
                    Reason
                    <!--<mfDefaultSorter by="reason?!"><span class="table-header">Reason</span></mfDefaultSorter>-->
                  </th>
                  <th class="text-center">
                    <mfDefaultSorter by="amoi"><span class="table-header">AMOI</span></mfDefaultSorter>
                  </th>
                  <th>
                    <mfDefaultSorter by="date_verified"><span class="table-header">Confirmation Date</span></mfDefaultSorter>
                  </th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let item of mftablePatientsAwaiting.data">
                  <td routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}">
                    <a href [routerLink]="['/patients', item.psn]" class="link-none"><i class="fa fa-user"></i> {{item.psn | dashify}}</a>
                  </td>
                  <td><a href [routerLink]="['/patients', item.psn]" class="link-none"><i class="fa fa-tasks"></i> {{item.bsn | dashify}}</a></td>
                  <td><a href [routerLink]="['/patients', item.psn]" class="link-none"><i class="fa fa-share-alt"></i> {{item.msn | dashify}}</a></td>
                  <td class="text-center"><a href [routerLink]="['/patients/' + item.psn + '/variant_reports/' + item.analysisId]" class="link-none"><i class="fa fa-file-text-o"></i></a></td>
                  <td>AWAITING DATA</td>
                  <td class="text-center">
                    <span *ngIf="item.amoi===true"><i class="fa fa-check-circle text-success-light"></i></span>
                    <span *ngIf="item.amoi===false"><i class="fa fa-times-circle text-danger-light"></i></span>
                  </td>
                  <td>{{item.date_verified | dashify}}</td>
                </tr>
                <tr *ngIf="mftablePatientsAwaiting.data.length == 0">
                  <td class="text-muted" colspan="7">No matching search results found for "{{searchtermPatientsAwaiting}}"</td>
                </tr>
              </tbody>
              <tfoot>
                <tr>
                  <td class="tfoot-padding" colspan="7">
                    <mfBootstrapPaginator [rowsOnPageSet]="[10,25,50,100]" [search]="searchtermPatientsAwaiting" [totallength]="tablePatientsAwaitingData.length"></mfBootstrapPaginator>
                  </td>
                </tr>
              </tfoot>
            </table>
          </div>
        </div>
      </div>
      <!-- end panel -->
    </div>
  </div>
</div>
